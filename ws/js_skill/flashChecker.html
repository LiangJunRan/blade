<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<script>
		// flash环境检测方法
		function flashChecker() {
			var hasFlash = 0; //是否安装了flash
			var flashVersion = 0; //flash版本
			if (document.all) {
				var swf = new ActiveXObject('ShockwaveFlash.ShockwaveFlash');
				if (swf) {
					hasFlash = 1;
					VSwf = swf.GetVariable("$version");
					flashVersion = parseInt(VSwf.split(" ")[1].split(",")[0]);
				}
			} else {
				if (navigator.plugins && navigator.plugins.length > 0) {
					var swf = navigator.plugins["Shockwave Flash"];
					if (swf) {
						hasFlash = 1;
						var words = swf.description.split(" ");
						for (var i = 0; i < words.length; ++i) {
							if (isNaN(parseInt(words[i]))) continue;
							flashVersion = parseInt(words[i]);
						}
					}
				}
			}
			return {hasFlash: hasFlash, version: flashVersion};
		}
		var result = flashChecker();
		document.write('是否安装了flash: ' + result.hasFlash + '');
	</script>
</body>
</html>