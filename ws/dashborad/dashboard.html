<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>dashboard demo</title>
	<!-- 调试用的多余代码 START -->
 	<link rel="stylesheet" href="../_commons/bootstrap/css/bootstrap.min.css">
 	<link rel="stylesheet" href="../_commons/font-awesome/css/font-awesome.min.css">
	<script src="../_commons/jquery/jquery.min.js"></script>
	<script src="../_commons//bootstrap/js/bootstrap.min.js"></script>
	<script src="../_commons/echarts/echarts.min.js"></script>
	<!-- 调试用的多余代码 =END= -->

	<link rel="stylesheet" href="../_commons/my/popup/popup.css">
	<script src="../_commons/my/popup/popup.js"></script>
	<style>
		.no-margin {
			margin: 0 0 0 0;
		}
		.v-space-15 {
			margin-top: 15px;
			margin-bottom: 15px;
		}
		.bim-chart-panel {
			border: 1px solid #2876b4;
			border-radius: 10px;
			background-color: #10396d;
			color: #fff;
			padding: 15px;
			font-family: "微软雅黑";
			width: calc(100% + 0px);
			height: 350px;
			margin-bottom: 20px;
		}

		.bim-chart-panel-head {
			color: #6cc5e7;
			font-size: 16px;
			font-weight: 700;
			border-bottom: solid 1px #2876b4;
		}

		.bim-chart-panel:hover {
			box-shadow: 0px 0px 25px 10px #59f;
		}

		.bim-chart-panel + .pop {
			box-shadow: 0px 0px 50px 20px #59f;
		}

		.btn-my {
			background-color: transparent;
		}

		.echart-btns {
			position: absolute;
			top: 40px;
			left: 25px;
			z-index: 50;
		}

		.echart-btns button:focus {
			outline: none!important;
		}

		.echart-btns * {
			color: #6cc5e7;
		}

		.echart-btns:hover * {
			color: #8ce5f7;
		}
	</style>
</head>
<body>
	<div class="row no-margin v-space-15" id="charts_container">
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-warning"></i>
					本月告警记录
				</div>
				<div class="bim-chart-panel-body">
					<div id="warningThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-list-ul"></i>
					本月事件记录
				</div>
				<div class="bim-chart-panel-body">
					<div id="eventThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-bar-chart"></i>
					本月问题记录
				</div>
				<div class="bim-chart-panel-body">
					<div id="problemThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-line-chart"></i>
					PUE曲线
				</div>
				<div class="bim-chart-panel-body">
					<div id="pueThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-pie-chart"></i>
					能耗分布
				</div>
				<div class="bim-chart-panel-body">
					<div id="powerStructureThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-area-chart"></i>
					健康曲线
				</div>
				<div class="bim-chart-panel-body">
					<div id="healthThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-dashboard"></i>
					容量
				</div>
				<div class="bim-chart-panel-body">
					<!-- <div class="echart-btns">
						<button class="btn btn-sm btn-my" type="button">
							<i class="fa fa-2x fa-arrow-circle-o-left" title="返回"></i>
						</button>
					</div> -->
					<div id="capacityThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-dashboard"></i>
					变更发布（资产）
				</div>
				<div class="bim-chart-panel-body">
					<div id="assetsThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
		<div class="col-lg-4 col-md-4 col-sm-6 col-xs-12">
			<div class="bim-chart-panel">
				<div class="bim-chart-panel-head">
					<i class="fa fa-pie-chart"></i>
					设备故障曲线（总览）
				</div>
				<div class="bim-chart-panel-body">
					<div id="deviceDownRateThisMonth" style="width: 537px; height: 300px;"></div>
				</div>
			</div>
		</div>
	</div>

	<script>
		// 初始化
 		$(document).ready(function() {
 			main_init();
		});
		// 响应宽度
		$(window).resize(function(){
			resizeAllCharts();
		})
		// 主初始化方法
		function main_init() {
			eventBind_init();
			warningThisMonth_init();
			eventThisMonth_init();
			problemThisMonth_init();
			pueThisMonth_init();
			powerStructureThisMonth_init();
			healthThisMonth_init();
			capacityThisMonth_init();
			assetsThisMonth_init();
			deviceDownRateThisMonth_init();
		}

		// 事件绑定的方法
		function eventBind_init() {
			// 绑定显示事件
			$("#charts_container").show(500, function(){
				resizeAllCharts();
			});

			// 绑定点击弹出
			bindPopup('.bim-chart-panel', 'dblclick', {
				width: '800px',
				height: '600px',
				beforePop: function(node, opts) {
					// 弹出框内的chart直接定义到弹出后的样式，并执行resize，相当于弹出框的弹出和resize()同时执行
					node.find('[id$=ThisMonth]').css({
						'width': (parseInt(opts.width.replace(/px/g, '')) - 30) + 'px',
						'height': (parseInt(opts.height.replace(/px/g, '')) - 52) + 'px'
					});
					var eInst = echarts.getInstanceByDom(node.find('[id$=ThisMonth]')[0]);
					if (eInst) {
						eInst.resize();
					}
				},
				beforeRecover: function(node, opts){
					// 同时执行recover和resize
					var dm = node.data().dummy;
					node.find('[id$=ThisMonth]').css({'width': dm.width() + 'px', 'height': (dm.height() - 23) + 'px'});
					var eInst = echarts.getInstanceByDom(node.find('[id$=ThisMonth]')[0]);
					if (eInst) {
						eInst.resize();
					}
				}
			});
		}

		// resize所有图表
		function resizeAllCharts() {
			$.each($('[id$=ThisMonth]'), function(){
				setWHByContainer(this);
				var eInst = echarts.getInstanceByDom(this);
				if (eInst) {
					eInst.resize();
				}
			});
		}

		// 根据图表的容器改变width和height
		function setWHByContainer(el) {
			if ($(el).parent().width() != 0) {
				$(el).css('width', $(el).parent().width() + 'px');
			}
			if ($(el).closest('.bim-chart-panel').height() != 0) {
				var body_height = $(el).closest('.bim-chart-panel').height() - 23;
				$(el).css('height', body_height + 'px');
			}
		}

		function warningThisMonth_init() {
			var el = $('#warningThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				textStyle: {
					color: '#6cc5e7'
				},
				tooltip: {},
				legend: {
					show: false,
					textStyle: {
						color: "#6cc5e7"
					}
				},
				xAxis: {
					data: ["2016-11-w1", "2016-11-w2", "2016-11-w3", "2016-11-w4", "2016-11-w5"],
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				},
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					}
				},
				visualMap: {
					show: false,
					min: 0,
					max: 50,
					color: ["#f00", "#ff0", "#0f0"]
				},
				series: [{
					name: "次数",
					type: "bar",
					barWidth: '30%',
					data: [45, 23, 2, 21, 43],
					itemStyle: {
						normal: {
							color: '#d00'/* ,
							borderColor: '#09f' */
						},
						emphasis: {
							color: "#f00"/* ,
							borderColor: '#0ff' */
						}
					},
					label: {
						normal: {
							show: true,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: true,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}]
			};

			chart.setOption(option);
		}

		function eventThisMonth_init() {
			var el = $('#eventThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				/* title: {
					text: "本月告警记录"
				}, */
				textStyle: {
					color: '#6cc5e7'
				},
				tooltip: {},
				legend: {
					show: false,
					/* data: ["次数"], */
					textStyle: {
						color: "#6cc5e7"
					}
				},
				/* grid: {
					show: false,
					borderColor: "#6cc5e7"
				}, */
				xAxis: {
					data: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26', '27', '28', '29', '30', '31'],
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				},
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					}
				},
				visualMap: {
					show: false,
					min: 0,
					max: 1000,
					inRange: {
						/* colorLightness: [0.1, 0.5] */
						color: ["#0f0", "#ff0", "#f00"]
					}
				},
				series: [{
					/* name: "次数", */
					type: "line",
					borderColor: "#f00",
					/* barWidth: '30%', */
					data: [580, 781, 60, 580, 239, 64, 746, 195, 128, 279, 7, 57, 58, 835, 753, 851, 533, 26, 249, 92, 381, 351, 614, 182, 448, 842, 954, 113, 364, 618, 404],
					itemStyle: {
						normal: {
							color: '#d00'/* ,
							borderColor: '#09f' */
						},
						emphasis: {
							color: "#f00"/* ,
							borderColor: '#0ff' */
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: true,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}]
			};

			chart.setOption(option);
		}

		function problemThisMonth_init() {
			var el = $('#problemThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				textStyle: {
					color: '#6cc5e7'
				},
				tooltip: {},
				legend: {
					orient: 'vertical',
					align: 'left',
					top: '3%',
					right: '1%',
					textStyle: {
						color: "#6cc5e7"
					},
					data: ['已解决', '待确认', '未解决']
				},
				xAxis: {
					data: ['1st', '2nd', '3rd', '4th', '5th'],
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				},
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					}
				},
				series: [{
					name: "已解决",
					type: "bar",
					borderColor: "#f00",
					barWidth: '30%',
					stack: '合计',
					data: [249, 92, 381, 351, 614],
					itemStyle: {
						normal: {
							color: '#0d0'
						},
						emphasis: {
							color: "#0f0"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}, {
					name: "待确认",
					type: "bar",
					borderColor: "#f00",
					barWidth: '30%',
					stack: '合计',
					data: [33, 26, 249, 92, 34],
					itemStyle: {
						normal: {
							color: '#dd0'
						},
						emphasis: {
							color: "#ff0"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}, {
					name: "未解决",
					type: "bar",
					borderColor: "#f00",
					barWidth: '30%',
					stack: '合计',
					data: [533, 26, 249, 92, 34],
					itemStyle: {
						normal: {
							color: '#d00'
						},
						emphasis: {
							color: "#f00"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}]
			};

			chart.setOption(option);
		}

		function pueThisMonth_init() {
			var el = $('#pueThisMonth')[0];
			var chart = echarts.init(el);

			var st_time = "2016-01-01",
				ed_time = "2016-12-31";

			var pue_data = [['2016-01-02', 1.407], ['2016-01-03', 1.449], ['2016-01-04', 1.408], ['2016-01-05', 1.327], ['2016-01-06', 1.441], ['2016-01-07', 1.576], ['2016-01-08', 1.389], ['2016-01-09', 1.33], ['2016-01-10', 1.526], ['2016-01-11', 1.489], ['2016-01-12', 1.418], ['2016-01-13', 1.6], ['2016-01-14', 1.533], ['2016-01-15', 1.491], ['2016-01-16', 1.539], ['2016-01-17', 1.596], ['2016-01-18', 1.363], ['2016-01-19', 1.416], ['2016-01-20', 1.552], ['2016-01-21', 1.384], ['2016-01-22', 1.304], ['2016-01-23', 1.333], ['2016-01-24', 1.594], ['2016-01-25', 1.579], ['2016-01-26', 1.362], ['2016-01-27', 1.47], ['2016-01-28', 1.598], ['2016-01-29', 1.528], ['2016-01-30', 1.446], ['2016-01-31', 1.368], ['2016-02-01', 1.324], ['2016-02-02', 1.345], ['2016-02-03', 1.372], ['2016-02-04', 1.572], ['2016-02-05', 1.519], ['2016-02-06', 1.351], ['2016-02-07', 1.404], ['2016-02-08', 1.363], ['2016-02-09', 1.386], ['2016-02-10', 1.508], ['2016-02-11', 1.547], ['2016-02-12', 1.304], ['2016-02-13', 1.551], ['2016-02-14', 1.458], ['2016-02-15', 1.448], ['2016-02-16', 1.407], ['2016-02-17', 1.503], ['2016-02-18', 1.361], ['2016-02-19', 1.383], ['2016-02-20', 1.356], ['2016-02-21', 1.326], ['2016-02-22', 1.577], ['2016-02-23', 1.496], ['2016-02-24', 1.318], ['2016-02-25', 1.56], ['2016-02-26', 1.358], ['2016-02-27', 1.329], ['2016-02-28', 1.435], ['2016-02-29', 1.399], ['2016-03-01', 1.347], ['2016-03-02', 1.539], ['2016-03-03', 1.571], ['2016-03-04', 1.304], ['2016-03-05', 1.443], ['2016-03-06', 1.489], ['2016-03-07', 1.583], ['2016-03-08', 1.433], ['2016-03-09', 1.3], ['2016-03-10', 1.44], ['2016-03-11', 1.336], ['2016-03-12', 1.308], ['2016-03-13', 1.572], ['2016-03-14', 1.332], ['2016-03-15', 1.486], ['2016-03-16', 1.538], ['2016-03-17', 1.396], ['2016-03-18', 1.418], ['2016-03-19', 1.302], ['2016-03-20', 1.532], ['2016-03-21', 1.425], ['2016-03-22', 1.477], ['2016-03-23', 1.416], ['2016-03-24', 1.427], ['2016-03-25', 1.426], ['2016-03-26', 1.337], ['2016-03-27', 1.33], ['2016-03-28', 1.367], ['2016-03-29', 1.353], ['2016-03-30', 1.515], ['2016-03-31', 1.391], ['2016-04-01', 1.391], ['2016-04-02', 1.331], ['2016-04-03', 1.482], ['2016-04-04', 1.581], ['2016-04-05', 1.556], ['2016-04-06', 1.418], ['2016-04-07', 1.413], ['2016-04-08', 1.534], ['2016-04-09', 1.453], ['2016-04-10', 1.48], ['2016-04-11', 1.409], ['2016-04-12', 1.418], ['2016-04-13', 1.477], ['2016-04-14', 1.551], ['2016-04-15', 1.509], ['2016-04-16', 1.496], ['2016-04-17', 1.383], ['2016-04-18', 1.378], ['2016-04-19', 1.57], ['2016-04-20', 1.55], ['2016-04-21', 1.501], ['2016-04-22', 1.537], ['2016-04-23', 1.473], ['2016-04-24', 1.568], ['2016-04-25', 1.374], ['2016-04-26', 1.524], ['2016-04-27', 1.317], ['2016-04-28', 1.498], ['2016-04-29', 1.599], ['2016-04-30', 1.457], ['2016-05-01', 1.331], ['2016-05-02', 1.485], ['2016-05-03', 1.448], ['2016-05-04', 1.394], ['2016-05-05', 1.465], ['2016-05-06', 1.408], ['2016-05-07', 1.41], ['2016-05-08', 1.474], ['2016-05-09', 1.523], ['2016-05-10', 1.335], ['2016-05-11', 1.365], ['2016-05-12', 1.518], ['2016-05-13', 1.435], ['2016-05-14', 1.368], ['2016-05-15', 1.57], ['2016-05-16', 1.333], ['2016-05-17', 1.307], ['2016-05-18', 1.516], ['2016-05-19', 1.327], ['2016-05-20', 1.433], ['2016-05-21', 1.308], ['2016-05-22', 1.553], ['2016-05-23', 1.395], ['2016-05-24', 1.508], ['2016-05-25', 1.595], ['2016-05-26', 1.441], ['2016-05-27', 1.306], ['2016-05-28', 1.44], ['2016-05-29', 1.533], ['2016-05-30', 1.43], ['2016-05-31', 1.469], ['2016-06-01', 1.587], ['2016-06-02', 1.454], ['2016-06-03', 1.531], ['2016-06-04', 1.423], ['2016-06-05', 1.442], ['2016-06-06', 1.547], ['2016-06-07', 1.591], ['2016-06-08', 1.345], ['2016-06-09', 1.432], ['2016-06-10', 1.58], ['2016-06-11', 1.495], ['2016-06-12', 1.352], ['2016-06-13', 1.463], ['2016-06-14', 1.364], ['2016-06-15', 1.545], ['2016-06-16', 1.432], ['2016-06-17', 1.357], ['2016-06-18', 1.306], ['2016-06-19', 1.346], ['2016-06-20', 1.481], ['2016-06-21', 1.519], ['2016-06-22', 1.493], ['2016-06-23', 1.309], ['2016-06-24', 1.388], ['2016-06-25', 1.526], ['2016-06-26', 1.5], ['2016-06-27', 1.574], ['2016-06-28', 1.455], ['2016-06-29', 1.555], ['2016-06-30', 1.416], ['2016-07-01', 1.327], ['2016-07-02', 1.48], ['2016-07-03', 1.577], ['2016-07-04', 1.587], ['2016-07-05', 1.594], ['2016-07-06', 1.41], ['2016-07-07', 1.5], ['2016-07-08', 1.428], ['2016-07-09', 1.595], ['2016-07-10', 1.504], ['2016-07-11', 1.506], ['2016-07-12', 1.49], ['2016-07-13', 1.411], ['2016-07-14', 1.359], ['2016-07-15', 1.42], ['2016-07-16', 1.373], ['2016-07-17', 1.442], ['2016-07-18', 1.434], ['2016-07-19', 1.566], ['2016-07-20', 1.565], ['2016-07-21', 1.594], ['2016-07-22', 1.348], ['2016-07-23', 1.495], ['2016-07-24', 1.56], ['2016-07-25', 1.506], ['2016-07-26', 1.47], ['2016-07-27', 1.531], ['2016-07-28', 1.474], ['2016-07-29', 1.525], ['2016-07-30', 1.58], ['2016-07-31', 1.409], ['2016-08-01', 1.317], ['2016-08-02', 1.466], ['2016-08-03', 1.536], ['2016-08-04', 1.464], ['2016-08-05', 1.535], ['2016-08-06', 1.456], ['2016-08-07', 1.596], ['2016-08-08', 1.599], ['2016-08-09', 1.426], ['2016-08-10', 1.54], ['2016-08-11', 1.525], ['2016-08-12', 1.435], ['2016-08-13', 1.505], ['2016-08-14', 1.518], ['2016-08-15', 1.573], ['2016-08-16', 1.445], ['2016-08-17', 1.392], ['2016-08-18', 1.475], ['2016-08-19', 1.492], ['2016-08-20', 1.585], ['2016-08-21', 1.369], ['2016-08-22', 1.532], ['2016-08-23', 1.579], ['2016-08-24', 1.453], ['2016-08-25', 1.362], ['2016-08-26', 1.553], ['2016-08-27', 1.507], ['2016-08-28', 1.488], ['2016-08-29', 1.598], ['2016-08-30', 1.44], ['2016-08-31', 1.318], ['2016-09-01', 1.34], ['2016-09-02', 1.397], ['2016-09-03', 1.431], ['2016-09-04', 1.335], ['2016-09-05', 1.578], ['2016-09-06', 1.441], ['2016-09-07', 1.511], ['2016-09-08', 1.343], ['2016-09-09', 1.379], ['2016-09-10', 1.357], ['2016-09-11', 1.556], ['2016-09-12', 1.54], ['2016-09-13', 1.464], ['2016-09-14', 1.52], ['2016-09-15', 1.503], ['2016-09-16', 1.566], ['2016-09-17', 1.574], ['2016-09-18', 1.469], ['2016-09-19', 1.434], ['2016-09-20', 1.38], ['2016-09-21', 1.512], ['2016-09-22', 1.52], ['2016-09-23', 1.568], ['2016-09-24', 1.403], ['2016-09-25', 1.313], ['2016-09-26', 1.475], ['2016-09-27', 1.412], ['2016-09-28', 1.302], ['2016-09-29', 1.405], ['2016-09-30', 1.596], ['2016-10-01', 1.537], ['2016-10-02', 1.337], ['2016-10-03', 1.455], ['2016-10-04', 1.326], ['2016-10-05', 1.561], ['2016-10-06', 1.315], ['2016-10-07', 1.342], ['2016-10-08', 1.402], ['2016-10-09', 1.589], ['2016-10-10', 1.59], ['2016-10-11', 1.515], ['2016-10-12', 1.384], ['2016-10-13', 1.41], ['2016-10-14', 1.429], ['2016-10-15', 1.471], ['2016-10-16', 1.43], ['2016-10-17', 1.471], ['2016-10-18', 1.301], ['2016-10-19', 1.356], ['2016-10-20', 1.403], ['2016-10-21', 1.375], ['2016-10-22', 1.498], ['2016-10-23', 1.583], ['2016-10-24', 1.428], ['2016-10-25', 1.36], ['2016-10-26', 1.559], ['2016-10-27', 1.351], ['2016-10-28', 1.554], ['2016-10-29', 1.567], ['2016-10-30', 1.552], ['2016-10-31', 1.361], ['2016-11-01', 1.358], ['2016-11-02', 1.548], ['2016-11-03', 1.469], ['2016-11-04', 1.535], ['2016-11-05', 1.472], ['2016-11-06', 1.557], ['2016-11-07', 1.346], ['2016-11-08', 1.419], ['2016-11-09', 1.511], ['2016-11-10', 1.525], ['2016-11-11', 1.359], ['2016-11-12', 1.536], ['2016-11-13', 1.501], ['2016-11-14', 1.399], ['2016-11-15', 1.447], ['2016-11-16', 1.42], ['2016-11-17', 1.493], ['2016-11-18', 1.532], ['2016-11-19', 1.524], ['2016-11-20', 1.404], ['2016-11-21', 1.495], ['2016-11-22', 1.477], ['2016-11-23', 1.568], ['2016-11-24', 1.427], ['2016-11-25', 1.514], ['2016-11-26', 1.399], ['2016-11-27', 1.418], ['2016-11-28', 1.306], ['2016-11-29', 1.431], ['2016-11-30', 1.465], ['2016-12-01', 1.567], ['2016-12-02', 1.525], ['2016-12-03', 1.391], ['2016-12-04', 1.384], ['2016-12-05', 1.6], ['2016-12-06', 1.555], ['2016-12-07', 1.554], ['2016-12-08', 1.42], ['2016-12-09', 1.599], ['2016-12-10', 1.484], ['2016-12-11', 1.311], ['2016-12-12', 1.43], ['2016-12-13', 1.45], ['2016-12-14', 1.573], ['2016-12-15', 1.441], ['2016-12-16', 1.409], ['2016-12-17', 1.324], ['2016-12-18', 1.34], ['2016-12-19', 1.343], ['2016-12-20', 1.359], ['2016-12-21', 1.553], ['2016-12-22', 1.397], ['2016-12-23', 2.521], ['2016-12-24', 3.398], ['2016-12-25', 4.463], ['2016-12-26', 4.551], ['2016-12-27', 4.569], ['2016-12-28', 4.344], ['2016-12-29', 4.416], ['2016-12-30', 1.377], ['2016-12-31', 1.538]];

			var option = {
				textStyle: {
					color: '#6cc5e7'
				},
				tooltip: {},
				legend: {
					show: false,
					textStyle: {
						color: "#6cc5e7"
					}
				},
				xAxis: [{
					type: 'time',
					min: new Date(st_time.replace(/-/g, "/")),
					max: new Date(ed_time.replace(/-/g, "/")),
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				}],
				yAxis: {
					type: 'value',
					min: 0,
					max: 5,
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					}
				},
				visualMap: {
					show: false,
					min: -3,
					max: 5,
					inRange: {
						/* colorLightness: [0.1, 0.5] */
						color: ["#00f", "#0ff", "#0f0", '#ff0', '#f00']
					}
				},
				dataZoom: [
					{
						type: 'slider',
						show: true,
						xAxisIndex: [0],
						height: 20,
						bottom: '2%',
						startValue: '2016-12-01',
						endValue: '2016-12-31',
						backgroundColor: 'rgba(0, 0, 0, 0.1)',
						fillerColor: 'rgba(0, 120, 255, 0.3)',
						dataBackground: {
							lineStyle: {
								width: 1,
								color: "#8ce5f7",
								opacity: 1
							}
						},
						borderColor: 'rgba(0, 0 ,0, 0)',
						handleSize: '100%',
						handleStyle: {
							color: "#6cc5e7",
							borderColor: '#f00',
							borderWidth: 0,
							borderType: 'solid',
							opacity: 1,
						}
					},
					{
						type: 'inside',
						xAxisIndex: [0]
					},
				],
				series: [{
					type: "line",
					borderColor: "#f00",
					data: pue_data,
					itemStyle: {
						normal: {
							color: '#0d0'
						},
						emphasis: {
							color: "#0f0"
						}
					},
					markLine: {
						silent: true,
						symbol: 'none',
						data: [
							{
								name: '最优',
								label: {
									normal: {
										show: true,
										formatter: '{b}:{c}'
									}
								},
								yAxis: 1,
								lineStyle: {
									normal: {
										color: '#0f0',
										type: 'dashed',
										opacity: 1
									}
								}
							},
							{
								name: '平均',
								type: 'average',
								label: {
									normal: {
										show: true,
										formatter: '{b}:{c}'
									}
								},
								lineStyle: {
									normal: {
										color: '#ff0',
										type: 'dashed',
										opacity: 1
									}
								}
							},
							{
								name: '最大',
								type: 'max',
								label: {
									normal: {
										show: true,
										formatter: '{b}:{c}'
									}
								},
								lineStyle: {
									normal: {
										width: 1,
										color: '#f55',
										type: 'dotted',
										opacity: 1
									}
								}
							},
							{
								name: '最小',
								type: 'min',
								label: {
									normal: {
										show: true,
										formatter: '{b}:{c}'
									}
								},
								lineStyle: {
									normal: {
										width: 1,
										color: '#5f5',
										type: 'dotted',
										opacity: 1
									}
								}
							},
						]
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: true,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}]
			};

			chart.setOption(option);
		}

		function powerStructureThisMonth_init() {
			var el = $('#powerStructureThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				tooltip: {
					trigger: 'item',
					formatter: "{a} <br/>{b}: {c} ({d}%)"
				},
				legend: {
					orient: 'vertical',
					align: 'left',
					top: '10%',
					right: '1%',
					textStyle: {
						color: "#6cc5e7"
					},
					data:['服务器','路由设备','辅助设备','路由','HUB','负载均衡','安全监控','防火系统','门禁系统','其他']
				},
				series: [
					{
						name: '访问来源',
						type: 'pie',
						center: ['40%', '50%'],
						selectedMode: 'single',
						radius: [0, '30%'],

						label: {
							normal: {
								position: 'inner'
							}
						},
						labelLine: {
							normal: {
								show: false
							}
						},
						data:[
							{value:335, name:'服务器', selected:true},
							{value:679, name:'路由设备'},
							{value:1548, name:'辅助设备'}
						]
					},
					{
						name: '访问来源',
						type: 'pie',
						center: ['40%', '50%'],
						radius: ['40%', '55%'],

						data:[
							{value:335, name:'服务器'},
							{value:310, name:'路由'},
							{value:234, name:'HUB'},
							{value:135, name:'负载均衡'},
							{value:1048, name:'空调系统'},
							{value:251, name:'防火系统'},
							{value:147, name:'门禁系统'},
							{value:102, name:'其他'}
						]
					}
				]
			};

			chart.setOption(option);
		}

		function healthThisMonth_init() {
			var el = $('#healthThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				tooltip : {
					trigger: 'axis',
					axisPointer:{
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				},
				textStyle: {
					color: '#6cc5e7'
				},
				legend: {
					textStyle: {
						color: "#6cc5e7"
					},
					top: '4%',
					data:['服务器','路由设备','空调系统','备用系统','其他']
				},
				/*toolbox: {
					feature: {
						saveAsImage: {}
					}
				},*/
				grid: {
					left: '3%',
					right: '4%',
					bottom: '3%',
					containLabel: true
				},
				xAxis : [
					{
						type : 'category',
						boundaryGap : false,
						axisTick: {
							show: false
						},
						axisLine: {
							show: true,
							lineStyle: {
								color: "#6cc5e7"
							}
						},
						data: ['周一','周二','周三','周四','周五','周六','周日']
					}
				],
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					},
					type : 'value'
				},
				/*yAxis : [
					{
						type : 'value'
					}
				],*/
				series : [
					{
						name:'服务器',
						type:'line',
						stack: '总量',
						areaStyle: {normal: {}},
						data: [100, 100, 97.5, 100, 99, 100, 100]
					},
					{
						name:'路由设备',
						type:'line',
						stack: '总量',
						areaStyle: {normal: {}},
						data: [100, 100, 97.5, 100, 95, 100, 100]
					},
					{
						name:'空调系统',
						type:'line',
						stack: '总量',
						areaStyle: {normal: {}},
						data: [100, 100, 90, 100, 99, 100, 100]
					},
					{
						name:'备用系统',
						type:'line',
						stack: '总量',
						areaStyle: {normal: {}},
						data: [100, 100, 80, 100, 99, 100, 100]
					},
					{
						name:'其他',
						type:'line',
						stack: '总量',
						label: {
							normal: {
								show: true,
								position: 'top'
							}
						},
						areaStyle: {normal: {}},
						data: [100, 100, 40, 100, 50, 100, 100]
					}
				]
			};

			chart.setOption(option);
		}

		function capacityThisMonth_init() {
			var el = $('#capacityThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				title: {
					show: false
				},
				tooltip: {
					trigger: 'item',
					formatter: "{a} <br/>{b} : {c} ({d}%)"
				},
				toolbox: {
					show: true,
					orient: "horizontal",
					top: "2%",
					left: "2%",
					feature: {
						/*mark : {show: true},
			            dataView : {show: true, readOnly: false},
			            magicType : {show: true, type: ['line', 'bar']},
			            saveAsImage : {show: true},
						restore: {},*/
        				mytool: {
        					show: true,
				        	title: '返回',
				        	icon:"image://assets/back.png",
					        onclick: function (){
					        	reChart(option2);
					        }
					    }
					},
					iconStyle: {
						normal: {
							color: '#6cc5e7'
						},
						emphasis: {
							color: '#6cc5e7'
						}
					}
				},
				// 横向根据数据渐变
				visualMap: {
					seriesIndex: [1],		// 指定针对哪个serie起作用
					show: false,
					min: 0,
					max: 100,
					color: ["#f00", "#ff0", "#0f0"],
					inverse: false,			// 反向
					dimension: 0,			// 渐变元 <- data的维度
					orient: 'horizontal'	// 筛选器横向
				},
				grid: [
					{
						x: '65%',
						y: '10%',
						width:'30%',
						height: '80%',
						show: false
					}
				],
				xAxis: {
					max: 100,
					axisLabel: {
						show: false
					},
					axisTick: {
						show: false
					},
					axisLine: {
						show: false
					},
					splitLine: {
						show: false
					},
				},
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: false,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						show: false
					},
					boundaryGap: ['100%', '100%'],
					inverse: true,
					data: ["区域1", "区域2", "区域3", "区域4", "区域5"]
				},
				series : [
					{
						type:'pie',
						radius : ['40%', '60%'],
						center : ['28%', '50%'],
						width:'30%',
						height: '80%',
						// roseType : 'radius',
						label: {
							normal: {
								show: true
							},
							emphasis: {
								show: true
							}
						},
						data:[
							{
								value: 120,
								name: 'A级',
								itemStyle: {
						            emphasis: {
						                color: '#f63',
						                shadowBlur: 10,
						                shadowColor: '#f63'
						            }
						        }
							},
							{
								value: 40,
								name: 'B级',
								itemStyle: {
						            emphasis: {
						                color: '#9f3',
						                shadowBlur: 10,
						                shadowColor: '#9f3'
						            }
						        }
							},
							{
								value: 55,
								name: 'C级',
								itemStyle: {
						            emphasis: {
						                color: '#3bf',
						                shadowBlur: 10,
						                shadowColor: '#3bf'
						            }
						        }
							}
						],
						color: ['#f63', '#9f3', '#3bf']
						// color: ['#fff']
					}, {
						type:'bar',
						barWidth: '40%',
						label: {
							normal: {
								show: true,
								position: 'right',
								textStyle: {
									color: "#6cc5e7"
								}
							},
							emphasis: {
								show: true
							}
						},
						data: [98, 44, 79, 27, 10]
					}
				]
			};

			var percent = 0.65;

			function getColor(percent) {
				var r;
				if (percent <= 0.5) {
					r = parseInt(percent * 2 * 255);
				} else {
					r = 255;
				}
				var g;
				if (percent >= 0.5) {
					g = parseInt((0.5 - percent) * 2 * 255 + 255);
				} else {
					g = 255;
				}
				console.log('rgb(' + r +',' +g + ', 0)');
				return 'rgb(' + r +',' +g + ', 0)';
			}

			function getData() {
			    return [{
			    	name: '已使用',
			        value: percent,
			        itemStyle: {
			            normal: {
			                color: getColor(percent),
			                shadowBlur: 10,
			                shadowColor: getColor(percent)
			            }
			        }
			    }, {
			    	name: '未使用',
			        value: 1 - percent,
			        itemStyle: {
			            normal: {
			                color: 'rgb(32, 97, 140)'
			            }
			        }
			    }];
			}

			var option2 = {
				title: {
					text: (percent * 100) + '%',
					x: 'center',
					y: 'center',
					textStyle: {
						color: '#6cc5e7',
						fontWeight: 'bolder',
						fontSize: 64,
					}
				},
				legend: {
					orient: 'vertical',
					align: 'left',
					top: '10%',
					right: '1%',
					textStyle: {
						color: "#6cc5e7"
					},
					data:['已使用', '未使用']
				},
				series: [
					/*{
						type: 'pie',
						radius: ['55%', '75%'],
						silent: true,
						label: {
							normal: {
								show: false,
							}
						},

						data: [{
							itemStyle: {
								normal: {
									color: 'rgb(32, 97, 140)'
								}
							}
						}],

						animation: true
					},*/
					{
						name: 'main',
						type: 'pie',
						radius: ['57%', '73%'],
						label: {
							normal: {
								show: false,
							}
						},
						data: getData(),

						animationEasingUpdate: 'cubicInOut',
						animationDurationUpdate: 500
					}
				]
			};

			function bindClick() {
				chart.on('click', function (params) {
					// 控制台打印数据的名称
					console.log(params);
					if (params.seriesName == 'main') {
						reChart(option);
					}
					return event;
				});
			}

			function reChart(the_option) {
				echarts.dispose(el);
				chart = echarts.init(el);
				chart.setOption(the_option);
				bindClick();
			}

			chart.setOption(option2);
			bindClick();
		}

		// TODO
		function assetsThisMonth_init() {
			var el = $('#assetsThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				tooltip: {
					trigger: 'item',
					formatter: "{a} <br/>{b}: {c} ({d}%)"
				},
				legend: {
					orient: 'vertical',
					align: 'left',
					top: '10%',
					right: '1%',
					textStyle: {
						color: "#6cc5e7"
					},
					data:['可用部分','不可用部分', '使用中', '备用中', '出库中', '入库中', '其他']
				},
				series: [
					{
						name: '访问来源',
						type: 'pie',
						center: ['40%', '50%'],
						selectedMode: 'single',
						radius: [0, '30%'],

						label: {
							normal: {
								position: 'inner'
							}
						},
						labelLine: {
							normal: {
								show: false
							}
						},
						data:[
							{value: 1800, name:'可用部分'},
							{value: 1850, name:'不可用部分'}
						]
					},
					{
						name: '访问来源',
						type: 'pie',
						center: ['40%', '50%'],
						radius: ['40%', '55%'],

						data:[
							{value: 1600, name:'使用中'},
							{value: 200, name:'备用中'},
							{value: 1000, name:'出库中'},
							{value: 500, name:'入库中'},
							{value: 350, name:'其他'}
						]
					}
				]
			};

			chart.setOption(option);
		}

		// TODO
		function deviceDownRateThisMonth_init() {
			var el = $('#deviceDownRateThisMonth')[0];
			var chart = echarts.init(el);

			var option = {
				textStyle: {
					color: '#6cc5e7'
				},
				tooltip: {},
				legend: {
					orient: 'vertical',
					align: 'left',
					top: '3%',
					right: '1%',
					textStyle: {
						color: "#6cc5e7"
					},
					data: ['可选设备', '辅助设备', '重要设备']
				},
				xAxis: {
					data: ['1st', '2nd', '3rd', '4th', '5th'],
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					}
				},
				yAxis: {
					axisTick: {
						show: false
					},
					axisLine: {
						show: true,
						lineStyle: {
							color: "#6cc5e7"
						}
					},
					splitLine: {
						lineStyle: {
							color: "#6cc5e7",
							opacity: 0.5
						}
					}
				},
				series: [{
					name: "可选设备",
					type: "line",
					borderColor: "#f00",
					barWidth: '30%',
					data: [139, 92, 30, 11, 224],
					itemStyle: {
						normal: {
							color: '#0d0'
						},
						emphasis: {
							color: "#0f0"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}, {
					name: "辅助设备",
					type: "line",
					borderColor: "#f00",
					barWidth: '30%',
					data: [33, 26, 2, 12, 34],
					itemStyle: {
						normal: {
							color: '#dd0'
						},
						emphasis: {
							color: "#ff0"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}, {
					name: "重要设备",
					type: "line",
					borderColor: "#f00",
					barWidth: '30%',
					data: [3, 21, 19, 2, 1],
					itemStyle: {
						normal: {
							color: '#d00'
						},
						emphasis: {
							color: "#f00"
						}
					},
					label: {
						normal: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#6cc5e7"
							}
						},
						emphasis: {
							show: false,
							position: 'top',
							textStyle: {
								color: "#8ce5f7"
							}
						}
					}
				}]
			};

			chart.setOption(option);
		}
	</script>
</body>
</html>